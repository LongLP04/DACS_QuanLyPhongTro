@model List<DACS_QuanLyPhongTro.Models.PhieuHienTrangNhanPhong>

@{
    ViewData["Title"] = "Danh Sách Phiếu Hiện Trạng Nhận Phòng";
	Layout = "/Areas/ChuTroArea/Views/Shared/layoutAdmin.cshtml";
}

<div class="container mt-5">
    <h2>Danh Sách Phiếu Hiện Trạng Nhận Phòng</h2>

    @if (TempData["ThongBao"] != null)
    {
            <div class="alert alert-success" id="thongBao">
            @TempData["ThongBao"]
            </div>
    }

    @if (Model.Count == 0)
    {
            <div class="alert alert-info">
                Không có phiếu hiện trạng nào.
            </div>
    }
    else
    {
        @foreach (var phieu in Model)
        {
                    <div class="card mb-3">
                        <div class="card-header">
                            Phiếu Hiện Trạng - Ngày nhận: @phieu.NgayNhanPhong.ToString("dd/MM/yyyy HH:mm")
                            <span class="badge badge-secondary float-right">@phieu.TinhTrang</span>
                        </div>
                        <div class="card-body">
                            <h5 class="card-title">Khách thuê: @phieu.KhachThue?.HoTen</h5>
                            <p class="card-text">Ghi chú: @phieu.GhiChu</p>
                            <table class="table table-striped">
                                <thead>
                                    <tr>
                                        <th>Tên Vật Dụng</th>
                                        <th>Tình Trạng</th>
                                    </tr>
                                </thead>
                                <tbody>
                            @if (phieu.HienTrangVatDungs != null && phieu.HienTrangVatDungs.Any())
                            {
                                @foreach (var vatDung in phieu.HienTrangVatDungs)
                                {
                                                    <tr>
                                                        <td>@vatDung.TenVatDung</td>
                                                        <td>@vatDung.TinhTrang</td>
                                                    </tr>
                                }
                            }
                            else
                            {
                                            <tr><td colspan="2">Không có vật dụng nào.</td></tr>
                            }
                                </tbody>
                            </table>
                        </div>
                    </div>
        }
    }

    <a asp-action="ChonPhong" class="btn btn-primary">Tạo Phiếu Mới</a>
    <a asp-action="Index" asp-controller="Home" asp-area="ChuTroArea" class="btn btn-secondary">Quay Lại</a>
</div>

@section Scripts {
        <script>
            document.addEventListener("DOMContentLoaded", function () {
                var thongBao = document.getElementById("thongBao");
                if (thongBao) {
                    setTimeout(function () {
                        thongBao.style.transition = "opacity 0.5s ease-out";
                        thongBao.style.opacity = "0";
                        setTimeout(function () {
                            thongBao.style.display = "none";
                        }, 500);
                    }, 5000);
                }
            });
        </script>
}